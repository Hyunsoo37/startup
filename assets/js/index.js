const translations = {
  ko: {
    hero_title: "Welcome to SAMK",
    hero_subtitle: "Start at Mason Korea - ì°½ì—…ê³¼ ê°œë°œì˜ ì‹œìž‘",
    about_title: "ì†Œê°œ",
    about_content:
      "SAMKëŠ” ì°½ì—…ê³¼ ê°œë°œì„ ì‚¬ëž‘í•˜ëŠ” í•™ìƒë“¤ì´ ëª¨ì—¬ ì•„ì´ë””ì–´ë¥¼ ì‹¤í˜„í•˜ê³  í•¨ê»˜ ì„±ìž¥í•˜ëŠ” ì¡°ì§€ë©”ì´ìŠ¨ ê¸€ë¡œë²Œìº í¼ìŠ¤ ê¸°ë°˜ì˜ ë™ì•„ë¦¬ìž…ë‹ˆë‹¤ã€‚",
    team_title: "íŒ€",
    team_content:
      "SAMKëŠ” ë‹¤ì–‘í•œ íŒ€ ë‹¨ìœ„ë¡œ ì•„ì´ë””ì–´ë¥¼ ë°œì „ì‹œí‚¤ê³  í˜‘ì—…í•˜ëŠ” ê³¼ì •ì„ ì¤‘ì‹œí•©ë‹ˆë‹¤. ê° íŒ€ì€ ê³ ìœ í•œ ì£¼ì œì™€ ëª©í‘œë¥¼ ê°–ê³  ë…ì°½ì ì¸ í”„ë¡œì íŠ¸ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤ã€‚",
    team_dif_title: "DIF",
    team_dif_content:
      "ì§€ì—­ì‚¬íšŒ ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ ë””ì§€í„¸ ì†”ë£¨ì…˜ì„ ê°œë°œí•˜ëŠ” ê¸°ìˆ  ì¤‘ì‹¬ íŒ€ìž…ë‹ˆë‹¤ã€‚",
    team_jun_title: "Jun",
    team_jun_content:
      "ì°½ì˜ì ì¸ ë””ìžì¸ê³¼ ì‚¬ìš©ìž ê²½í—˜ì„ í†µí•´ ì°¨ë³„í™”ëœ ì„œë¹„ìŠ¤ë¥¼ êµ¬ìƒí•˜ëŠ” ë””ìžì¸ ì¤‘ì‹¬ íŒ€ìž…ë‹ˆë‹¤ã€‚",
    team_sydney_title: "Sydney",
    team_sydney_content:
      "ê¸€ë¡œë²Œ ì‹œìž¥ì„ ê²¨ëƒ¥í•œ ìŠ¤íƒ€íŠ¸ì—… í”„ë¡œì íŠ¸ë¥¼ ê¸°íší•˜ê³  ì‹¤í–‰í•˜ëŠ” ê¸€ë¡œë²Œ ì „ëžµ íŒ€ìž…ë‹ˆë‹¤ã€‚",
    events_title: "í•´ì»¤í†¤ ì •ë³´",
    events_content: "SAMKê°€ ì†Œê°œí•˜ëŠ” ì™¸ë¶€ í•´ì»¤í†¤ê³¼ ëŒ€íšŒ ì •ë³´ìž…ë‹ˆë‹¤ã€‚",
    events_hackathon1_title: "ðŸŽ¯ ì´ë¯¸ì§€ ë¶„ë¥˜ í•´ì»¤í†¤",
    events_hackathon1_content: "ë°ì´í„° ì† ì•„ì´ì½˜ì˜ ì¢…ë¥˜ë¥¼ ë§ží˜€ë¼!",
    events_hackathon2_title: "ðŸ§  ê¸°ì—… ì„±ê³µ í™•ë¥  ì˜ˆì¸¡ í•´ì»¤í†¤",
    events_hackathon2_content: "ë¯¸ëž˜ì˜ ì„±ê³µê¸°ì—…ì„ ë°œêµ´í•˜ë¼!",
    events_hackathon3_title: "Snowflake & Streamlit í•´ì»¤í†¤",
    events_hackathon3_content: "ë°ì´í„°ë¡œ ì•„ì´ë””ì–´ë¥¼ í˜„ì‹¤ë¡œ ë§Œë“¤ê³  ì‹¶ë‹¤ë©´?",
    learn_more: "ë” ì•Œì•„ë³´ê¸° â†’",
    timeline_title: "íƒ€ìž„ë¼ì¸",
    timeline_content: "SAMKì˜ ì£¼ìš” í™œë™ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”ã€‚",
    timeline_date1: "2024.10",
    timeline_event1_title: "ì²« ì´ë¯¸ì§€ ë¶„ë¥˜ í•´ì»¤í†¤",
    timeline_event1_content: "SAMKì˜ ì²« í•´ì»¤í†¤, ë°ì´í„°ë¡œ ì„¸ìƒì„ ë°”ê¾¸ë‹¤!",
    timeline_date2: "2025.03",
    timeline_event2_title: "ì°½ì—… ì„¸ë¯¸ë‚˜",
    timeline_event2_content: "ìŠ¤íƒ€íŠ¸ì—… ì „ë¬¸ê°€ì™€ í•¨ê»˜í•œ ì•„ì´ë””ì–´ ì›Œí¬ìˆ",
    timeline_date3: "2025.05",
    timeline_event3_title: "AI ì›Œí¬ìˆ (ì˜ˆì •)",
    timeline_event3_content: "AI ê¸°ìˆ ë¡œ ë¯¸ëž˜ë¥¼ ì„¤ê³„í•˜ëŠ” ì‹¤ìŠµ ì›Œí¬ìˆ",
    recruit_title: "ëª¨ì§‘ ì•ˆë‚´",
    recruit_content:
      "ì—° 2íšŒ ì‹ ìž… ëª¨ì§‘ (ë´„/ê°€ì„ í•™ê¸°). ìžì„¸í•œ ì¼ì •ì€ Instagram ë° ê³µì§€ì‚¬í•­ì„ í†µí•´ í™•ì¸í•´ì£¼ì„¸ìš”ã€‚",
    check_instagram: "Instagramì—ì„œ í™•ì¸í•˜ê¸°",
    apply_now: "ì§€ê¸ˆ ì§€ì›í•˜ê¸°",
  },
  en: {
    hero_title: "Welcome to SAMK",
    hero_subtitle:
      "Start at Mason Korea - The Beginning of Entrepreneurship and Development",
    about_title: "About",
    about_content:
      "SAMK is a student club at George Mason University Korea where passionate students come together to bring ideas to life and grow through entrepreneurship and development.",
    team_title: "Team",
    team_content:
      "SAMK values collaboration and idea development through diverse teams. Each team works on unique projects with distinct themes and goals.",
    team_dif_title: "DIF",
    team_dif_content:
      "A technology-focused team developing digital solutions to address community issues.",
    team_jun_title: "Jun",
    team_jun_content:
      "A design-focused team creating differentiated services through creative design and user experience.",
    team_sydney_title: "Sydney",
    team_sydney_content:
      "A global strategy team planning and executing startup projects targeting the international market.",
    events_title: "Hackathon Info",
    events_content:
      "Information on external hackathons and competitions introduced by SAMK.",
    events_hackathon1_title: "ðŸŽ¯ Image Classification Hackathon",
    events_hackathon1_content: "Identify the types of icons in the data!",
    events_hackathon2_title: "ðŸ§  Startup Success Prediction Hackathon",
    events_hackathon2_content: "Discover the future successful companies!",
    events_hackathon3_title: "Snowflake & Streamlit Hackathon",
    events_hackathon3_content: "Want to turn ideas into reality with data?",
    learn_more: "Learn More â†’",
    timeline_title: "Timeline",
    timeline_content: "Explore SAMK's key activities at a glance.",
    timeline_date1: "2024.10",
    timeline_event1_title: "First Image Classification Hackathon",
    timeline_event1_content:
      "SAMK's first hackathon, changing the world with data!",
    timeline_date2: "2025.03",
    timeline_event2_title: "Startup Seminar",
    timeline_event2_content: "Idea workshop with startup experts",
    timeline_date3: "2025.05",
    timeline_event3_title: "AI Workshop (Upcoming)",
    timeline_event3_content: "Hands-on workshop designing the future with AI",
    recruit_title: "Recruitment",
    recruit_content:
      "We recruit new members twice a year (Spring/Fall semesters). Check our Instagram and announcements for detailed schedules.",
    check_instagram: "Check on Instagram",
    apply_now: "Apply Now",
  },
};

const langButtons = document.querySelectorAll(".lang-btn");
const langElements = document.querySelectorAll("[data-lang-key]");
let currentLang = "ko";
let typingTimeout = null;
let isNavigating = false;

const teamData = {
  dif: {
    title: translations.ko.team_dif_title,
    members: "ë°•ìƒˆë´„(íŒ€ìž¥), í•˜íƒœì¤€, ì˜¤íƒœì¤€, ì´í˜„ìˆ˜",
  },
  jun: {
    title: translations.ko.team_jun_title,
    members: "ìµœë¯¼ìˆ˜ (ë¦¬ë”), ì •ìˆ˜ì§„ (UX ì „ë¬¸ê°€), ê¹€ë‹¤ì˜ (ê°œë°œìž)",
  },
  sydney: {
    title: translations.ko.team_sydney_title,
    members: "ì´í˜„ìš° (ë¦¬ë”), ë°•ì§€í›ˆ (ë§ˆì¼€í„°), ì†¡ë¯¼ì§€ (ê¸°íšìž)",
  },
};

function setLanguage(lang) {
  console.log(`setLanguage called with lang: ${lang}`);
  if (typingTimeout) {
    console.log("Clearing previous typing animation");
    clearTimeout(typingTimeout);
    typingTimeout = null;
  }
  currentLang = lang;
  teamData.dif.title = translations[lang].team_dif_title;
  teamData.jun.title = translations[lang].team_jun_title;
  teamData.sydney.title = translations[lang].team_sydney_title;
  langElements.forEach((el) => {
    let text = translations[lang][el.dataset.langKey];
    if (el.dataset.langKey === "hero_subtitle" && lang === "ko") {
      text = "Start at Mason Korea - ì°½ì—…ê³¼ ê°œë°œì˜ ì‹œìž‘";
    }
    if (el.id === "typing-text") {
      startTypingAnimation(text);
    } else {
      el.textContent = text;
    }
  });
  langButtons.forEach((btn) => {
    btn.classList.toggle("active", btn.dataset.lang === lang);
  });
  document.documentElement.lang = lang;
}

function startTypingAnimation(text) {
  const typingElement = document.getElementById("typing-text");
  if (!typingElement) {
    console.error("Typing element not found");
    return;
  }
  console.log(`Starting typing animation with text: ${text}`);
  if (typingTimeout) {
    console.log("Animation cleared before starting new");
    clearTimeout(typingTimeout);
  }
  typingElement.textContent = "";
  typingElement.classList.add("typing");
  let i = 0;
  function type() {
    if (i < text.length) {
      const char = text.charAt(i);
      typingElement.textContent += char;
      console.log(`Character added: ${char}`);
      i++;
      typingTimeout = setTimeout(type, 80);
    } else {
      typingElement.classList.remove("typing");
      console.log("Typing animation completed");
      typingTimeout = null;
    }
  }
  type();
}

function showModal(team) {
  console.log(`Showing modal for team: ${team}`);
  const modal = document.getElementById("team-modal");
  const modalTitle = document.getElementById("modal-title");
  const modalMembers = document.getElementById("modal-members");
  modalTitle.textContent = teamData[team].title;
  modalMembers.textContent = `Members: ${teamData[team].members}`;
  modal.style.display = "flex";
}

function closeModal() {
  console.log("Closing modal");
  document.getElementById("team-modal").style.display = "none";
}

langButtons.forEach((btn) => {
  btn.addEventListener("click", () => {
    console.log(`Language button clicked: ${btn.dataset.lang}`);
    setLanguage(btn.dataset.lang);
  });
});

const sections = document.querySelectorAll(".section, .hero");
let observer;

function setupIntersectionObserver() {
  observer = new IntersectionObserver(
    (entries) => {
      if (isNavigating) return;
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          console.log(`Section visible: ${entry.target.id || "hero"}`);
          sections.forEach((section) => {
            section.classList.add("hidden");
            section.classList.remove("visible");
          });
          entry.target.classList.remove("hidden");
          entry.target.classList.add("visible");
        }
      });
    },
    {
      threshold: 0.5,
      rootMargin: "-5% 0px",
    }
  );

  sections.forEach((section) => observer.observe(section));
}

const navLinks = document.querySelectorAll("nav ul li a");
navLinks.forEach((link) => {
  link.addEventListener("click", (e) => {
    e.preventDefault();
    const targetId = link.getAttribute("href").substring(1);
    const targetSection = document.getElementById(targetId);

    if (targetSection) {
      console.log(`Navigating to section: ${targetId}`);
      isNavigating = true;

      sections.forEach((section) => {
        section.classList.add("hidden");
        section.classList.remove("visible");
      });
      targetSection.classList.remove("hidden");
      targetSection.classList.add("visible");

      const navHeight = document.querySelector("nav").offsetHeight;
      const targetPosition =
        targetSection.getBoundingClientRect().top +
        window.pageYOffset -
        navHeight;
      window.scrollTo({
        top: targetPosition,
        behavior: "smooth",
      });

      setTimeout(() => {
        isNavigating = false;
        console.log("Navigation completed, re-enabling IntersectionObserver");
      }, 1000);
    } else {
      console.error(`Target section not found: ${targetId}`);
    }
  });
});

document.addEventListener("DOMContentLoaded", () => {
  console.log("DOM fully loaded");
  try {
    const typingElement = document.getElementById("typing-text");
    if (typingElement) {
      console.log("Initializing typing animation");
      setLanguage("ko");
    } else {
      console.error("Typing text element not found");
    }
    setupIntersectionObserver();
  } catch (error) {
    console.error("Initialization error:", error);
  }
});
